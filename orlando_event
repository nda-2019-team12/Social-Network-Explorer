
library(data.table)     # Run once per session
library(ggplot2)        # Run once per session
library(stringr)
library(igraph)

# Load previously saved data.
load("reddit_complete.RData")

# Add columns of "date" and "time" to the data table, splited from TIMESTAMP
dt.reddit.subset <- 
  dt.reddit.both[, date := str_split_fixed(dt.reddit.both$TIMESTAMP, " ", 2)[,1]]
dt.reddit.subset.time <- 
  dt.reddit.both[, time := str_split_fixed(dt.reddit.both$TIMESTAMP, " ", 2)[,2]]

# Change the characteristic of date and time
dt.reddit.subset.time$date <- as.Date(dt.reddit.subset.time$date, format = "%Y-%m-%d")
dt.reddit.subset.time$time <- as.Date(dt.reddit.subset.time$time, format = "%H:%M:%S")

# Set time filter based on the "date" column for 2 weeks around the Orlando shooting (12/06/2016)
dt.reddit.orlando <- subset(dt.reddit.subset.time, date > "2016-06-10" & date < "2016-06-21")

# Graph data frame
g.reddit.orlando <- graph.data.frame(dt.reddit.orlando[, list(SOURCE_SUBREDDIT, TARGET_SUBREDDIT)],
  directed = TRUE)
  
# Get summary
summary(g.reddit.orlando)

# Graph plot
  V(g.reddit.orlando)$title <- "Orlando shooting"
  V(g.reddit.orlando)$label <- "" 
  V(g.reddit.orlando)$size <- 50
  V(g.reddit.orlando)$frame.color <- "white"

  plot(g.reddit.orlando, vertex.size = 3, vertex.label = NA, edge.width=0.01, edge.arrow.size=.6, edge.color="gray85")


